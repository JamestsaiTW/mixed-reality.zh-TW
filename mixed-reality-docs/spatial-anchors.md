---
title: 空間錨點
description: 使用空間錨點轉譯穩定全像投影的最佳做法。
author: thetuvix
ms.author: alexturn
ms.date: 02/24/2019
ms.topic: article
ms.localizationpriority: high
keywords: 座標系統、空間座標系統、全球規模、全球、規模、位置、方向、錨點、空間錨點、已全球鎖定、正進行全球鎖定、持續性、共用
ms.openlocfilehash: 16165194d040ad22f7885897eddcc65cf9dcaec3
ms.sourcegitcommit: f20beea6a539d04e1d1fc98116f7601137eebebe
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/05/2019
ms.locfileid: "65730854"
---
# <a name="spatial-anchors"></a><span data-ttu-id="b4851-104">空間錨點</span><span class="sxs-lookup"><span data-stu-id="b4851-104">Spatial anchors</span></span>

<span data-ttu-id="b4851-105">空間錨點代表系統在一段時間中應該於真實世界中追蹤的一個重要時間點。</span><span class="sxs-lookup"><span data-stu-id="b4851-105">A spatial anchor represents an important point in the world that the system should keep track of over time.</span></span> <span data-ttu-id="b4851-106">每個錨點都有一個會視需要調整 (相對於其他錨點或參考架構) 的[座標系統](coordinate-systems.md) ，以確保錨定的全像投影能維持準確定位。</span><span class="sxs-lookup"><span data-stu-id="b4851-106">Each anchor has a [coordinate system](coordinate-systems.md) that adjusts as needed, relative to other anchors or frames of reference, in order to ensure that anchored holograms stay precisely in place.</span></span>  <span data-ttu-id="b4851-107">在錨點的座標系統中轉譯全像投影，可以在任何指定的時間為您提供最準確的全像投影定位。</span><span class="sxs-lookup"><span data-stu-id="b4851-107">Rendering a hologram in an anchor's coordinate system gives you the most accurate positioning for that hologram at any given time.</span></span> <span data-ttu-id="b4851-108">這樣做的代價是，需要隨時間推移小幅度調整全像投影的位置，因為系統會持續地依據它與現實世界的相對位置，將它移回原位。</span><span class="sxs-lookup"><span data-stu-id="b4851-108">This comes at the cost of small adjustments over time to the hologram's position, as the system continually moves it back into place relative to the real world.</span></span>

<span data-ttu-id="b4851-109">您也可以跨應用程式工作階段及跨裝置持續維持並共用空間錨點：</span><span class="sxs-lookup"><span data-stu-id="b4851-109">You can also persist and share spatial anchors across app sessions and across devices:</span></span>
* <span data-ttu-id="b4851-110">藉由將本機空間錨點儲存到磁碟並在之後將它們重新載入，您的應用程式可以在單一 HoloLens 設備上跨多個應用程式工作階段推斷現實世界中的相同位置。</span><span class="sxs-lookup"><span data-stu-id="b4851-110">By saving local spatial anchors to disk and loading them back later, your app can reason about the same location in the real world across multiple app sessions on a single HoloLens device.</span></span>
* <span data-ttu-id="b4851-111">藉由使用<a href="https://docs.microsoft.com/azure/spatial-anchors/overview" target="_blank">Azure Spatial Anchors</a> 建立雲端錨點，您的應用程式就能跨多個 HoloLens、iOS 和 Android 裝置共用空間錨點。</span><span class="sxs-lookup"><span data-stu-id="b4851-111">By using <a href="https://docs.microsoft.com/azure/spatial-anchors/overview" target="_blank">Azure Spatial Anchors</a> to create a cloud anchor, your app can share a spatial anchor across multiple HoloLens, iOS and Android devices.</span></span> <span data-ttu-id="b4851-112">透過讓每個裝置使用同一個空間錨點轉譯全像投影，所有使用者將會看到全像投影出現在真實世界中的相同位置。</span><span class="sxs-lookup"><span data-stu-id="b4851-112">By having each device render a hologram using the same spatial anchor, all users will see the hologram appear at the same place in the real world.</span></span>  <span data-ttu-id="b4851-113">這可提供即時共用體驗。</span><span class="sxs-lookup"><span data-stu-id="b4851-113">This allows for real-time shared experiences.</span></span>
* <span data-ttu-id="b4851-114">您也可以使用<a href="https://docs.microsoft.com/azure/spatial-anchors/overview" target="_blank">Azure Spatial Anchors</a> 跨 HoloLens、iOS 和 Android 裝置取得非同步全像投影持久性。</span><span class="sxs-lookup"><span data-stu-id="b4851-114">You can also use <a href="https://docs.microsoft.com/azure/spatial-anchors/overview" target="_blank">Azure Spatial Anchors</a> for asynchronous hologram persistence across HoloLens, iOS and Android devices.</span></span>  <span data-ttu-id="b4851-115">藉由共用持久的雲端空間錨點，多個裝置就能觀察相同的已保存全像投影一段時間，即使那些裝置並未同時存在。</span><span class="sxs-lookup"><span data-stu-id="b4851-115">By sharing a durable cloud spatial anchor, multiple devices can observe the same persisted hologram over time, even if those devices are not present together at the same time.</span></span>

<span data-ttu-id="b4851-116">對於將保持在 5 公尺直徑範圍內的受限制桌面混合實境頭戴式裝置的站立空間規模或室內空間規模體驗，您通常只需使用[舞台參考架構](coordinate-systems.md#stage-frame-of-reference)，而非空間錨點，就能為您提供可在其中呈現所有內容的單一座標系統。</span><span class="sxs-lookup"><span data-stu-id="b4851-116">For standing-scale or room-scale experiences for tethered desktop headsets that will stay within a 5-meter diameter, you can usually just use the [stage frame of reference](coordinate-systems.md#stage-frame-of-reference) instead of spatial anchors, providing you a single coordinate system in which to render all content.</span></span> <span data-ttu-id="b4851-117">但如果您的應用程式試圖讓用戶在 HoloLens 上漫步超過 5 米距離 (或許在建築物的整個樓層中操作)，您將需要使用空間錨點來維持內容穩定。</span><span class="sxs-lookup"><span data-stu-id="b4851-117">However, if your app intends to let users wander beyond 5 meters on HoloLens, perhaps operating throughout an entire floor of a building, you'll need spatial anchors to keep content stable.</span></span>

<span data-ttu-id="b4851-118">雖然空間錨點對於在真實世界中應保持固定的全像投影非常有用，但是一旦將錨點放至定位，就無法移動它。</span><span class="sxs-lookup"><span data-stu-id="b4851-118">While spatial anchors are great for holograms that should remain fixed in the world, once an anchor is placed, it can't be moved.</span></span> <span data-ttu-id="b4851-119">有一些錨點的替代項目更適合用於應該與使用者一起標記的動態全像投影。</span><span class="sxs-lookup"><span data-stu-id="b4851-119">There are alternatives to anchors that are more appropriate for dynamic holograms that should tag along with the user.</span></span> <span data-ttu-id="b4851-120">最好使用靜止的參考架構 (Unity 的世界座標基礎) 或附加的參考架構來定位動態全像投影。</span><span class="sxs-lookup"><span data-stu-id="b4851-120">It is best to position dynamic holograms using a stationary frame of reference (the foundation for Unity's world coordinates) or an attached frame of reference.</span></span>

## <a name="best-practices"></a><span data-ttu-id="b4851-121">最佳作法</span><span class="sxs-lookup"><span data-stu-id="b4851-121">Best practices</span></span>

<span data-ttu-id="b4851-122">這些空間錨點指南將協助您轉譯穩定、且能準確追蹤現實世界的全像投影。</span><span class="sxs-lookup"><span data-stu-id="b4851-122">These spatial anchor guidelines will help you render stable holograms that accurately track the real world.</span></span>

### <a name="create-spatial-anchors-where-users-place-them"></a><span data-ttu-id="b4851-123">建立使用者放置的空間錨點</span><span class="sxs-lookup"><span data-stu-id="b4851-123">Create spatial anchors where users place them</span></span>

<span data-ttu-id="b4851-124">在大部分情況下，應由使用者明確地放置空間錨點。</span><span class="sxs-lookup"><span data-stu-id="b4851-124">Most of the time, users should be the ones explicitly placing spatial anchors.</span></span>

<span data-ttu-id="b4851-125">例如在 HoloLens 上，應用程式可讓使用者的[視線](gaze.md)與[空間對應](spatial-mapping.md)網格交集，讓使用者決定放置全像投影的位置。</span><span class="sxs-lookup"><span data-stu-id="b4851-125">For example, on HoloLens, an app can intersect the user's [gaze](gaze.md) ray with the [spatial mapping](spatial-mapping.md) mesh to let the user decide where to place a hologram.</span></span> <span data-ttu-id="b4851-126">當用戶點選以放置該全像投影時，在交叉點位置建立空間錨點，然後將全像投影放置在該錨點的座標系統原點。</span><span class="sxs-lookup"><span data-stu-id="b4851-126">When the user taps to place that hologram, create a spatial anchor at the intersection point and then place the hologram at the origin of that anchor's coordinate system.</span></span>

<span data-ttu-id="b4851-127">本機空間錨點非常易於創建，而且如果多個錨點可以共用其基本感應器資料，系統將能合併其內部資料。</span><span class="sxs-lookup"><span data-stu-id="b4851-127">Local spatial anchors are easy and performant to create, and the system will consolidate their internal data if multiple anchors can share their underlying sensor data.</span></span> <span data-ttu-id="b4851-128">除了下面概述的情況 (例如固定的全像投影群組) 之外，您通常應該為使用者明確放置的每個全像投影建立新的本機空間錨點。</span><span class="sxs-lookup"><span data-stu-id="b4851-128">You should typically create a new local spatial anchor for each hologram that a user explicitly places, except in cases outlined below such as rigid groups of holograms.</span></span>

### <a name="always-render-anchored-holograms-within-3-meters-of-their-anchor"></a><span data-ttu-id="b4851-129">一律轉譯位於錨點 3 公尺範圍內的錨定全像投影</span><span class="sxs-lookup"><span data-stu-id="b4851-129">Always render anchored holograms within 3 meters of their anchor</span></span>

<span data-ttu-id="b4851-130">空間錨點可穩固錨點原始位置附近的座標系統。</span><span class="sxs-lookup"><span data-stu-id="b4851-130">Spatial anchors stabilize their coordinate system near the anchor's origin.</span></span> <span data-ttu-id="b4851-131">如果您轉譯距離該原始位置約 3 公尺範圍之外的現全像投影，那些全像投影可能會因為槓桿臂效應，而在與原始位置的距離上，出現明顯的比例定位錯誤。</span><span class="sxs-lookup"><span data-stu-id="b4851-131">If you render holograms more than about 3 meters from that origin, those holograms may experience noticeable positional errors in proportion to their distance from that origin, due to lever-arm effects.</span></span> <span data-ttu-id="b4851-132">這適用於使用者站在錨點附近的情況，由於全像投影也距離使用者較遠，這意味著遠距離全像投影的角度誤差會較小。</span><span class="sxs-lookup"><span data-stu-id="b4851-132">That works if the user stands near the anchor, since the hologram is far away from the user too, meaning the angular error of the distant hologram will be small.</span></span> <span data-ttu-id="b4851-133">但如果使用者走到遠距離的全像投影位置，他們的視野就會很大，這會使得遠距離的錨點原始位置產生相當明顯的槓桿臂效應。</span><span class="sxs-lookup"><span data-stu-id="b4851-133">However, if the user walks up to that distant hologram, it will then be large in their view, making the lever-arm effects from the faraway anchor origin quite obvious.</span></span>

### <a name="group-holograms-that-should-form-a-rigid-cluster"></a><span data-ttu-id="b4851-134">應形成固定叢集的群組全像投影</span><span class="sxs-lookup"><span data-stu-id="b4851-134">Group holograms that should form a rigid cluster</span></span>

<span data-ttu-id="b4851-135">如果應用程式希望那些全像投影彼此維持固定關係，可以讓多個全像投影共用同一個空間錨點。</span><span class="sxs-lookup"><span data-stu-id="b4851-135">Multiple holograms can share the same spatial anchor if the app expects those holograms to maintain fixed relationships to one another.</span></span>

<span data-ttu-id="b4851-136">例如，如果您要在房間中設置動態太陽系全像投影，最好將所有太陽系物件綁定到位於中央位置的單一錨點，讓它們彼此以固定的相對距離順暢地移動。</span><span class="sxs-lookup"><span data-stu-id="b4851-136">For example, if you are animating a holographic solar system in a room, it's better to tie all of the solar system objects to a single anchor in the center, so that they move smoothly relative to each other.</span></span> <span data-ttu-id="b4851-137">在這個情況下，即使各個元件部分會圍繞錨點動態移動，整個太陽系也會維持錨定狀態。</span><span class="sxs-lookup"><span data-stu-id="b4851-137">In this case, it is the solar system as a whole that is anchored, even though its component parts are moving dynamically around the anchor.</span></span>

<span data-ttu-id="b4851-138">這裡維持全像投影穩定性的關鍵點在於遵循上面的 3 公尺規則。</span><span class="sxs-lookup"><span data-stu-id="b4851-138">The key caveat here to maintain hologram stability is to follow the 3-meter rule above.</span></span>

### <a name="render-highly-dynamic-holograms-using-the-stationary-frame-of-reference-instead-of-a-local-spatial-anchor"></a><span data-ttu-id="b4851-139">使用靜止的參考架構而不是本機空間錨點來轉譯高動態全像投影</span><span class="sxs-lookup"><span data-stu-id="b4851-139">Render highly dynamic holograms using the stationary frame of reference instead of a local spatial anchor</span></span>

<span data-ttu-id="b4851-140">如果您有一個高度動態的全像投影，例如在房間內四處走動的角色，或在使用者附近沿著牆壁移動的浮動 UI，最好跳過本機空間錨點，並直接在[靜止的參考架構](coordinate-systems.md#stationary-frame-of-reference)提供的座標系統中直接轉譯那些全像投影 (也就是在 Unity 中，您可以透過將全像投影直接放置在沒有 WorldAnchor 的世界座標中來實現此目標)。</span><span class="sxs-lookup"><span data-stu-id="b4851-140">If you have a highly dynamic hologram, such as a character walking around the room, or a floating UI that follows along the wall near the user, it is best to skip local spatial anchors and render those holograms directly in the coordinate system provided by the [stationary frame of reference](coordinate-systems.md#stationary-frame-of-reference) (i.e. in Unity, you achieve this by placing holograms directly in world coordinates without a WorldAnchor).</span></span> <span data-ttu-id="b4851-141">當使用者遠離全像投影時，靜止的參考架構中的全像投影可能會出現漂移現象，但這對於動態全像投影來說並不明顯：因為全像投影會不斷移動，或是它在移動時會一直位於使用者附近，因此可以將漂移現象降到最低。</span><span class="sxs-lookup"><span data-stu-id="b4851-141">Holograms in a stationary frame of reference may experience drift when the user is far from the hologram, but this is less likely to be noticeable for dynamic holograms: either the hologram is constantly moving anyway, or its motion constantly keeps it close to the user, where drift will be minimized.</span></span>

<span data-ttu-id="b4851-142">動態全像投影的一個有趣的例子是一個物件從某個錨定座標系統移動至另一個座標系統的動畫。</span><span class="sxs-lookup"><span data-stu-id="b4851-142">One interesting case of dynamic holograms is an object that is animating from one anchored coordinate system to another.</span></span> <span data-ttu-id="b4851-143">例如，你有兩座相距 10 公尺的城堡，每座城堡都有自己的空間錨點，其中一座城堡向另一座城堡發射砲彈。</span><span class="sxs-lookup"><span data-stu-id="b4851-143">For example, you might have two castles 10 meters apart, each on their own spatial anchor, with one castle firing a cannonball at the other castle.</span></span> <span data-ttu-id="b4851-144">在砲彈發射時，您可以在靜止的參考架構中的適當位置轉譯該影像，以便與第一座城堡錨定座標系統中的大砲重合。</span><span class="sxs-lookup"><span data-stu-id="b4851-144">At the moment the cannonball is fired, you can render it at the appropriate location in the stationary frame of reference, so as to coincide with the cannon in the first castle's anchored coordinate system.</span></span> <span data-ttu-id="b4851-145">然後它可以在靜止的參考架構中追蹤砲彈在空中飛行 10 公尺的軌跡。</span><span class="sxs-lookup"><span data-stu-id="b4851-145">It can then follow its trajectory in the stationary frame of reference as it flies 10 meters through the air.</span></span> <span data-ttu-id="b4851-146">當砲彈到達另一座城堡時，你可以選擇將它移動到第二座城堡的錨定座標系統中，以便使用該城堡的固定位置進行物理計算。</span><span class="sxs-lookup"><span data-stu-id="b4851-146">As the cannonball reaches the other castle, you may choose to move it into the second castle's anchored coordinate system to allow for physics calculations with that castle's rigid bodies.</span></span>

<span data-ttu-id="b4851-147">如果您跨裝置共用高動態的全像投影，將需要挑選一些雲端空間錨點做為其父項，因為靜止的參考架構無法跨裝置共用。</span><span class="sxs-lookup"><span data-stu-id="b4851-147">If you are sharing a highly dynamic hologram across devices, you will need to pick some cloud spatial anchor to act as their parent, as stationary frames of reference cannot be shared across devices.</span></span>  <span data-ttu-id="b4851-148">但在此情況下，您應該確定動態全像投影或檢視投影的裝置都維持在錨點的 3 公尺計量半徑範圍內，以確保全像投影會在所有裝置上穩定地顯示。</span><span class="sxs-lookup"><span data-stu-id="b4851-148">However, in this case, you should ensure that either either the dynamic hologram or the devices viewing it remain within the anchor's 3 meter radius, to ensure the hologram appears stable on all devices.</span></span>

### <a name="avoid-creating-a-grid-of-spatial-anchors"></a><span data-ttu-id="b4851-149">避免建立空間錨點的網格</span><span class="sxs-lookup"><span data-stu-id="b4851-149">Avoid creating a grid of spatial anchors</span></span>

<span data-ttu-id="b4851-150">當使用者四處走動時，您可能會想讓應用程式刪除空間錨點的規則網格，在他們四處移動時，於錨點之間轉換動態物件。</span><span class="sxs-lookup"><span data-stu-id="b4851-150">You may be tempted to have your app drop a regular grid of spatial anchors as the user walks around, transitioning dynamic objects from anchor to anchor as they move around.</span></span> <span data-ttu-id="b4851-151">但這牽涉到應用程式的大量管理作業，無法享受到系統本身內部維護的深度感應器資料所能提供的好處。</span><span class="sxs-lookup"><span data-stu-id="b4851-151">However, this involves a lot of management for your app, without the benefit of the deep sensor data that the system itself maintains internally.</span></span> <span data-ttu-id="b4851-152">對於這些情況，您通常可以透過將全像投影放置在靜止的參考架構中，以獲得更好的結果，同時減少工作量，如上一節所述。</span><span class="sxs-lookup"><span data-stu-id="b4851-152">For these cases, you will usually achieve better results with less effort by placing your holograms in the stationary frame of reference, as described in the section above.</span></span>

<span data-ttu-id="b4851-153">在靜態空間周圍預先定位一組雲端空間錨點時，請考慮將空間錨點放置在使用者根據上述原則將遇到的關鍵全像投影所在位置，而不是建立一個任意錨點網格。</span><span class="sxs-lookup"><span data-stu-id="b4851-153">When pre-positioning a set of cloud spatial anchors around a static space, consider placing the spatial anchors at the locations of the key holograms the user will encounter per the principle above, rather than creating an arbitrary grid of anchors.</span></span>  <span data-ttu-id="b4851-154">這可確保您能夠讓那些關鍵的全像投影獲得最高的穩定性。</span><span class="sxs-lookup"><span data-stu-id="b4851-154">This ensures that you'll get maximum stability for those key holograms.</span></span>

### <a name="release-local-spatial-anchors-you-no-longer-need"></a><span data-ttu-id="b4851-155">釋出您不再需要的本機空間錨點</span><span class="sxs-lookup"><span data-stu-id="b4851-155">Release local spatial anchors you no longer need</span></span>

<span data-ttu-id="b4851-156">當本機空間錨點在使用中時，系統將優先保留該錨點附近的感應器資料。</span><span class="sxs-lookup"><span data-stu-id="b4851-156">While a local spatial anchor is active, the system will prioritize keeping around the sensor data that is near that anchor.</span></span> <span data-ttu-id="b4851-157">如果您無法再使用空間錨點，請停止存取其座標系統。</span><span class="sxs-lookup"><span data-stu-id="b4851-157">If you are no longer using a spatial anchor, stop accessing its coordinate system.</span></span> <span data-ttu-id="b4851-158">這可讓系統在必要時移除其基礎感應器資料。</span><span class="sxs-lookup"><span data-stu-id="b4851-158">This will allow its underlying sensor data to be removed as necessary.</span></span>

<span data-ttu-id="b4851-159">對於您已保存至空間錨點存放區的本機錨點來說，這一點特別重要。</span><span class="sxs-lookup"><span data-stu-id="b4851-159">This is especially important for local anchors you have persisted to the spatial anchor store.</span></span> <span data-ttu-id="b4851-160">這些錨點背後的感應器資料將永久保留，以允許您的應用程式在未來的工作階段中找到該錨點，但這將會使可用於追蹤其他錨點的空間減少。</span><span class="sxs-lookup"><span data-stu-id="b4851-160">The sensor data behind these anchors will be kept around permanently to allow your app to find that anchor in future app sessions, which will reduce the space available to track other anchors.</span></span> <span data-ttu-id="b4851-161">因此請只保留未來的工作階段中需要再次尋找的本地錨點，並在使用者不再需要時，將它們從存放區中移除。</span><span class="sxs-lookup"><span data-stu-id="b4851-161">Persist only those local anchors that you need to find again in future sessions and remove them from the store when they are no longer meaningful to the user.</span></span>

<span data-ttu-id="b4851-162">對於雲端空間錨點，您的儲存體可以依照案例需要調整規模。</span><span class="sxs-lookup"><span data-stu-id="b4851-162">For cloud spatial anchors, your storage can scale as your scenario requires.</span></span>  <span data-ttu-id="b4851-163">您可以根據需要且不受限制地儲存許多雲端錨點，並只在您知道使用者不需要再次尋找該錨點上的全像投影時才將它們釋出。</span><span class="sxs-lookup"><span data-stu-id="b4851-163">You may store as many cloud anchors as needed, releasing them only when you know that your users will not need to locate holograms at that anchor again.</span></span>

## <a name="see-also"></a><span data-ttu-id="b4851-164">請參閱</span><span class="sxs-lookup"><span data-stu-id="b4851-164">See also</span></span>
* [<span data-ttu-id="b4851-165">座標系統</span><span class="sxs-lookup"><span data-stu-id="b4851-165">Coordinate systems</span></span>](coordinate-systems.md)
* [<span data-ttu-id="b4851-166">混合實境中的共用體驗</span><span class="sxs-lookup"><span data-stu-id="b4851-166">Shared experiences in mixed reality</span></span>](shared-experiences-in-mixed-reality.md)
* <span data-ttu-id="b4851-167"><a href="https://docs.microsoft.com/azure/spatial-anchors" target="_blank">Azure Spatial Anchors</a></span><span class="sxs-lookup"><span data-stu-id="b4851-167"><a href="https://docs.microsoft.com/azure/spatial-anchors" target="_blank">Azure Spatial Anchors</a></span></span>
* [<span data-ttu-id="b4851-168">Unity 中的持續性</span><span class="sxs-lookup"><span data-stu-id="b4851-168">Persistence in Unity</span></span>](persistence-in-unity.md)
* [<span data-ttu-id="b4851-169">DirectX 中的空間錨點</span><span class="sxs-lookup"><span data-stu-id="b4851-169">Spatial anchors in DirectX</span></span>](coordinate-systems-in-directx.md#place-holograms-in-the-world-using-spatial-anchors)
* [<span data-ttu-id="b4851-170">案例研究 - 在實境中的的透視技術</span><span class="sxs-lookup"><span data-stu-id="b4851-170">Case study - Looking through holes in your reality</span></span>](case-study-looking-through-holes-in-your-reality.md)
