---
title: 座標系統
description: 空間座標系統, 用來建立站上、室內、房間規模和全球規模的混合現實體驗。
author: thetuvix
ms.author: alexturn
ms.date: 02/24/2019
ms.topic: article
keywords: 座標系統, 空間座標系統, 僅限方向, 固定規模, 大規模, 室內規模, 世界級, 360 度, 內部, 室內, 房間, 世界, 尺規, 位置, 方向, 固定, 附加, 階段, 錨點, 空間錨點,世界-鎖定, 世界鎖定, 內文鎖定, 內文鎖定, 界限, 持續性, 共用, 追蹤遺失, 雲端空間錨點
ms.openlocfilehash: f4b945a3ffb83b9ac0a94e0d793a19939aece3bb
ms.sourcegitcommit: 17f86fed532d7a4e91bd95baca05930c4a5c68c5
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/11/2019
ms.locfileid: "66829857"
---
# <a name="coordinate-systems"></a>座標系統

在其核心中, 混合現實應用程式會將[全息影像](hologram.md)放在您的世界中, 看起來像是真正的物件。 這牽涉到在世界各地對使用者有意義的那些全息的位置, 以及您所建立的實體室或虛擬領域的定位。 當您的全像投影的位置和方向, 或任何其他幾何 (例如,[注視](gaze.md)光線或[手](gestures.md)中的位置) 發生位置和方向時, Windows 會提供可表示幾何的各種真實全局座標系統, 稱為**空間座標系統**。

<br>

>[!VIDEO https://www.youtube.com/embed/TneGSeqVAXQ]

## <a name="device-support"></a>裝置支援

<table>
    <colgroup>
    <col width="40%" />
    <col width="20%" />
    <col width="20%" />
    <col width="20%" />
    </colgroup>
    <tr>
        <td><strong>功能</strong></td>
        <td><a href="hololens-hardware-details.md"><strong>HoloLens (第 1 代)</strong></a></td>
        <td><strong>HoloLens 2</strong></td>
        <td><a href="immersive-headset-hardware-details.md"><strong>沉浸式頭戴裝置</strong></a></td>
    </tr>
     <tr>
        <td><a href="coordinate-systems.md#stationary-frame-of-reference">固定的參考框架</a></td>
        <td>✔️</td>
        <td>✔️</td>
        <td>✔️</td>
    </tr>
    <tr>
        <td><a href="coordinate-systems.md#attached-frame-of-reference">參考的附加框架</a></td>
        <td>✔️</td>
        <td>✔️</td>
        <td>✔️</td>
    </tr>
    <tr>
        <td><a href="coordinate-systems.md#stage-frame-of-reference">參考的階段框架</a></td>
        <td>尚不支援</td>
        <td>尚不支援</td>
        <td>✔️</td>
    </tr>
    <tr>
        <td><a href="coordinate-systems.md#spatial-anchors">空間錨點</a></td>
        <td>✔️</td>
        <td>✔️</td>
        <td>✔️</td>
    </tr>
    <tr>
        <td><a href="spatial-mapping.md">空間對應</a></td>
        <td>✔️</td>
        <td>✔️</td>
        <td>❌</td>
    </tr>
</table>

## <a name="mixed-reality-experience-scales"></a>混合現實體驗調整

Mixed reality 應用程式可以設計成廣泛的使用者體驗, 從360度的影片檢視器, 只需要耳機的方向, 到完全全球規模的應用程式和遊戲, 需要空間對應和空間錨點:
<br>

| 經驗調整 | 需求 | 範例體驗 | 
|----------|----------|----------|
|  **僅限方向** |  **耳機方向**(引力對齊) |  360影片檢視器 | 
|  **固定規模** |  上方, 加上**頭戴式裝置位置**(相對於零位置) |  賽車遊戲或空間模擬器 | 
|  **大規模** |  以上, 加上**階段樓層來源** |  您已準備好並減到不變的動作遊戲  | 
|  **會議室規模** |  以上, 加上**階段界限多邊形** |  拼圖遊戲, 您可以在其中逐步解說謎題 | 
|  **全球規模** |  **空間錨點**(通常是[空間對應](spatial-mapping.md)) |  敵人來自您真實牆的遊戲, 例如[RoboRaid](https://www.microsoft.com/p/roboraid/9nblggh5fv3j) | 

這些體驗會依照「嵌套玩偶」模型來調整。 這裡適用于 Windows Mixed Reality 的主要設計原則是, 指定的耳機支援針對目標體驗調整所建立的應用程式, 以及所有較小的規模:
<br>

| 6DOF 追蹤 | 樓層已定義 | 360°追蹤 | 已定義界限 | 空間錨點 | 最大體驗 | 
|----------|----------|----------|----------|----------|----------|
|  否 |  - |  - |  - |  - |  **僅限方向** | 
|  **是** |  否 |  - |  - |  - |  **正確** | 
|  **是** |  **是** |  否 |  - |  - |  **正向** | 
|  **是** |  **是** |  **是** |  否 |  - |  **待命-360 °** | 
|  **是** |  **是** |  **是** |  **是** |  否 |  **處** | 
|  **是** |  **是** |  **是** |  **是** |  **是** |  **成為** | 

請注意, HoloLens 尚未支援參考的階段框架。 HoloLens 上的房間規模應用程式目前需要使用[空間對應](spatial-mapping.md)來尋找使用者的樓層和牆。

## <a name="spatial-coordinate-systems"></a>空間座標系統

所有的3D 圖形應用程式都是在其呈現的虛擬世界中, 使用[笛卡座標系統](https://docs.microsoft.com/windows/uwp/graphics-concepts/coordinate-systems)來進行物件的位置和方向。 這類座標系統會建立三個垂直軸, 以放置物件: X、Y 和 Z 軸。

在[混合現實](mixed-reality.md)中, 您的應用程式將會造成虛擬和實體座標系統的原因。 Windows 會呼叫實體世界中具有實際意義的座標系統, 即**空間座標系統**。

空間座標系統以計量表示其座標值。 這表示在混合現實中轉譯時, 在 X、Y 或 Z 軸中放置2個單位的物件將會彼此分離2個計量。 這可讓您輕鬆地以真實世界的規模呈現物件和環境。

在一般情況下, 笛卡座標系統可以是右手向或左手向。 Windows 上的空間座標系統一律是右手的, 這表示正 X 軸指向右方, 正 Y 軸會向上 (對齊引力), 而正 Z 軸會指向您。

在這兩種座標系統中, 正 X 軸指向右方, 而正 Y 軸則是向上。 差別在於正 Z 軸是否指向您的方向或遠離您。 您可以記住正 Z 軸點的方向, 其方式是將左或右手指指向正 X 方向, 並將其 curling 為正 Y 方向。 您的 thumb 點 (朝向您的方向) 是正 Z 軸指向該座標系統的方向。

## <a name="building-an-orientation-only-or-seated-scale-experience"></a>建立僅限方向或固定規模的體驗

全像攝影[轉譯](rendering.md)的關鍵, 是在使用者四處移動時, 變更應用程式在每個畫面格的全息影像視圖, 以符合其預測的 head 動作。 您可以使用**固定的參考框架**, 建立符合使用者的前端位置和前端方向變更的**大規模體驗**。

某些內容必須忽略標頭位置更新, 並保持固定在所選的標題, 以及與使用者的距離。 主要範例為360度的影片: 因為影片是從單一固定的觀點來捕捉, 所以會使視圖位置相對於內容的反射變得更好, 即使視圖方向必須隨著使用者的外觀而變更也一樣。 您可以使用**附加的參考框架**, 建立這類**僅限方向的體驗**。

### <a name="stationary-frame-of-reference"></a>固定的參考框架

固定的參考框架所提供的座標系統會運作, 讓使用者附近的物件位置盡可能穩定, 同時保有使用者的頭部位置變更。

針對[Unity](https://unity3d.com/)等遊戲引擎中的大規模體驗, 會定義引擎的「世界原點」, 這是固定的參考框架。 放在特定全局座標中的物件會使用固定的參考框架, 在實際世界中使用那些相同的座標來定義其位置。 即使使用者逐步解說, 在世界中的內容也稱為**世界鎖定**的內容。

應用程式通常會在啟動時建立一個固定的參考框架, 並在應用程式的存留期內使用其座標系統。 身為 Unity 中的應用程式開發人員, 您可以開始將內容相對於原點, 這會是使用者的初始標頭位置和方向。 如果使用者移至新位置, 而且想要繼續其大規模的經驗, 您可以在該位置 recenter 世界原點。

經過一段時間後, 當系統深入瞭解使用者的環境時, 可能會判斷真實世界中各個點之間的距離, 其長度比系統先前所認為的更短或更長。 如果您在 HoloLens 上呈現應用程式的靜止框架, 而使用者穿梭超過5個度量的範圍, 您的應用程式可能會觀察到那些全息影像觀察到的位置漂移。 如果您的經驗有超過5計量的使用者晃, 您就會建立[全球規模的體驗](#building-a-world-scale-experience), 而這需要額外的技術來保持全息影像的穩定, 如下所述。

### <a name="attached-frame-of-reference"></a>參考的附加框架

附加的參考框架會隨著使用者逐步移動, 並在應用程式第一次建立框架時定義固定標題。 這可讓使用者輕鬆地查看放置在該參考框架內的內容。 以這個使用者相對方式轉譯的內容稱為「**主體鎖定**內容」。

當耳機無法判斷其在世界中的位置時, 附加的參考框架會提供唯一可用來呈現全息影像的座標系統。 這非常適合顯示回溯 UI, 以告知使用者他們的裝置在世界中找不到它們。 已上延展或更高層級的應用程式應該包含僅限方向的回溯, 以協助使用者再次使用, 其 UI 與[混合現實首頁](navigating-the-windows-mixed-reality-home.md)中顯示的類似。

## <a name="building-a-standing-scale-or-room-scale-experience"></a>建立大規模或會議室的體驗

若要超越沉浸式耳機, 並打造大規模的**體驗**, 您可以使用**參考的階段框架**。

為了提供**會議室規模的體驗**, 讓使用者能夠在預先定義的5計量界限內四處進行, 您也可以檢查**階段界限**。

### <a name="stage-frame-of-reference"></a>參考的階段框架

當第一次設定沉浸式耳機時, 使用者會定義一個**階段**, 代表他們會遇到混合現實的房間。 階段最少定義一個**階段原點**, 這是一個以使用者選擇的樓層位置為中心的空間座標系統, 以及他們想要使用裝置的正向方向。 藉由將內容放在此階段座標系統中, 您可以在 Y = 0 floor 平面上, 確保您的全息影像在使用者坐在地上時能輕鬆地顯示, 並為使用者提供**大規模的體驗**。

### <a name="stage-bounds"></a>階段界限

使用者也可以選擇性地定義**階段界限**, 這是他們在房間內清除的區域, 他們想要在混合現實中四處移動。 若是如此, 應用程式可以使用這些界限來建立**會議室規模的體驗**, 以確保在使用者可以觸達影像的位置, 一律會放置全像投影。

因為參考的階段框架會提供單一固定座標系統, 以在其中放置樓層相關內容, 所以它是移植針對虛擬實境耳機所開發之大規模和房間規模應用程式的最簡單路徑。 不過, 就像使用的 VR 平臺一樣, 單一座標系統只能在大約5個計量 (16 英尺) 直徑的情況下穩定內容, 而當杆臂效果在系統調整時, 會導致從中心到上的內容變得很明顯。 若不超過5個計量, 就需要空間錨點。

## <a name="building-a-world-scale-experience"></a>建立全球規模的體驗

HoloLens 可提供真實的**全球規模體驗**, 讓使用者穿梭超過5計量。 若要建立全球規模的應用程式, 您需要新的技術, 而不是用於會議室規模的體驗。

### <a name="why-a-single-rigid-coordinate-system-cannot-be-used-beyond-5-meters"></a>為什麼單一固定座標系統無法使用超過5計量

今天, 撰寫遊戲、資料視覺效果應用程式或虛擬實境應用程式時, 一般的方法是建立一個絕對全局座標系統, 讓所有其他座標能夠可靠地對應回。 在該環境中, 您一律可以找到穩定的轉換, 以定義該世界中任何兩個物件之間的關聯性。 如果您未移動這些物件, 它們的相對轉換一律會保持不變。 這種全域座標系統的運作方式, 是在轉譯純粹的虛擬世界, 讓您事先知道所有的幾何。 今天, 會議室的 VR 應用程式通常會在樓層上建立這種絕對的房間縮放座標系統。

相較之下, 非網路共用 mixed reality 裝置 (如 HoloLens) 對世界具有動態感應器驅動的瞭解, 因為他們在整個建築樓層間進行了許多計量, 所以會在使用者周圍的一段時間內持續調整其知識。 在全球規模的體驗中, 如果您將所有的全息影像放在單一的固定座標系統中, 則這些全息影像在一段時間內一定會漂移, 不論是世界或彼此。

例如, 頭戴式裝置目前可能會認為世界上有兩個位置是4個計量, 然後在稍後精簡該瞭解, 並瞭解位置實際上是3.9 計量。 如果這些全息影像一開始在單一固定座標系統中放置4個計量, 則其中一項會一律從真實世界顯示0.1 計量。

### <a name="spatial-anchors"></a>空間錨點

Windows Mixed Reality 可解決上一節所述的問題, 方法是讓您建立[空間錨點](spatial-anchors.md), 以標記使用者已放置全息影像的世界中的重要點。 空間錨點代表系統在一段時間中應該於真實世界中追蹤的一個重要時間點。

當裝置學習到世界時, 這些空間錨點可以視需要調整其相對於彼此的位置, 以確保每個錨點會精確地放在相對於真實世界的位置。 藉由將空間錨點放在使用者放置全息圖形的位置, 然後相對於其空間錨點來定位該全像投影, 您可以確保全息表維持最佳穩定性, 即使使用者在數十個計量中漫遊也一樣。

相對於另一個空間錨點的這項連續調整, 是從空間錨點到座標系統與參考的固定框架之間的主要差異:

* 放在參考的固定框架中的全息影像, 全都保持彼此間的嚴格關聯性。 不過, 當使用者進行長距離的距離時, 該框架的座標系統可能會相對於世界, 確保使用者旁的全息影像看起來穩定。

* 放在參考階段框架中的全息影像也會保留彼此之間的固定關聯性。 相較于固定的框架, 階段框架一律會相對於其定義的實體來源固定在適當位置。 不過, 在階段的座標系統中轉譯超過其5計量界限的內容, 只有在使用者位於該界限內時, 才會顯示穩定。

* 使用一個空間錨點放置的全息影像, 可能會相對於使用另一個空間錨點的全息影像而漂移。 這可讓 Windows 改善其對每個空間錨點的瞭解, 即使有一個錨點需要自行調整, 而另一個錨點需要向右調整。

相對於固定的參考框架, 其一律會針對使用者附近的穩定性進行優化, 參考和空間錨點的階段框架會確保其來源附近的穩定性。 這可協助這些全息影像在一段時間內保持精確, 但這也表示從其座標系統的原點呈現的全息影像, 會遇到日益嚴重的拉杆臂效果。 這是因為階段或錨點的位置和方向的小型調整會與該錨點的距離成正比。 

理想的經驗法則是確保根據距離空間錨點座標系統所轉譯的任何內容, 都是在其原點大約3計量內。 對於鄰近的階段原點, 轉譯較遠的內容是正常的, 因為任何增加的位置錯誤將只會影響不會在使用者觀點中轉移的小型全息影像。

### <a name="spatial-anchor-persistence"></a>空間錨點持續性

空間錨點也可以讓您的應用程式在您的應用程式暫停或裝置關閉後, 記住重要的位置。

您可以將應用程式所建立的空間錨點儲存到磁片, 然後稍後再將它們保存在應用程式的**空間錨點存放區**, 以再次將它們重新載入。 儲存或載入錨點時, 您會提供對應用程式有意義的字串索引鍵, 以便稍後識別錨點。 請將此金鑰視為錨點的檔案名。 如果您想要將其他資料與該錨點產生關聯 (例如, 使用者置於該位置的3D 模型), 請將其儲存至您應用程式的本機儲存體, 並將它與您選擇的金鑰產生關聯。

藉由將錨點保存到存放區, 您的使用者可以放置個別的全息影像, 或放置一個工作區, 應用程式會在此放置其各種不同的全息影像, 然後在您的應用程式的許多用途之後, 于預期的位置尋找那些全息影像。

您也可以使用<a href="https://docs.microsoft.com/azure/spatial-anchors/overview" target="_blank">Azure Spatial Anchors</a> 跨 HoloLens、iOS 和 Android 裝置取得非同步全像投影持久性。  藉由共用持久的雲端空間錨點，多個裝置就能觀察相同的已保存全像投影一段時間，即使那些裝置並未同時存在。

### <a name="spatial-anchor-sharing"></a>空間錨點共用

您的應用程式也可以與其他裝置即時共用空間錨點, 以允許即時共用體驗。

藉由使用<a href="https://docs.microsoft.com/azure/spatial-anchors/overview" target="_blank">Azure 空間錨點</a>, 您的應用程式可以在多個 HoloLens、IOS 和 Android 裝置之間共用空間錨點。 透過讓每個裝置使用同一個空間錨點轉譯全像投影，所有使用者將會看到全像投影出現在真實世界中的相同位置。

## <a name="avoid-head-locked-content"></a>避免 head 鎖定的內容

我們強烈建議您不要轉譯 head 鎖定的內容, 這會保留在顯示的固定位置 (例如抬頭顯示器)。 一般來說, 對於使用者而言, head 鎖定的內容不會感到不安, 而且也不像世界自然的部分。

前端鎖定的內容通常會以附加至使用者或放在世界本身的全息影像來取代。 例如, 資料[指標](cursors.md)通常會被推入世界中, 並自然調整以反映物件在使用者注視下的位置和距離。

## <a name="handling-tracking-errors"></a>處理追蹤錯誤

在某些環境 (例如深色走廊) 中, 使用內建追蹤的耳機可能無法在世界中正確找出本身。 如果未正確處理, 這可能會導致全息影像不會顯示或顯示在不正確的位置。 我們現在會討論發生這種情況的情況、對使用者經驗的影響, 以及最佳處理這種情況的秘訣。

### <a name="headset-cannot-track-due-to-insufficient-sensor-data"></a>頭戴式裝置無法追蹤, 因為感應器資料不足

有時, 耳機的感應器無法找出耳機所在的位置。 如果房間很深, 或如果感應器是以頭髮或手來涵蓋, 或周圍沒有足夠的材質, 就可能發生這種情況。

發生這種情況時, 頭戴式裝置將無法追蹤其具有足夠精確度的位置來呈現世界鎖定的全息影像。 您無法找出空間錨點、固定框架或階段框架相對於裝置的位置, 但是您仍然可以在附加的參考框架中轉譯主體鎖定的內容。

您的應用程式應該告訴使用者如何取得位置追蹤, 並轉譯一些回溯主體鎖定內容來說明一些秘訣, 例如發掘感應器並開啟更多光源。

### <a name="headset-tracks-incorrectly-due-to-dynamic-changes-in-the-environment"></a>頭戴式裝置因為環境中的動態變更而不正確追蹤

有時候, 如果環境中有大量動態變更, 裝置就無法正確追蹤, 例如許多人在聊天室中走著。 在這種情況下, 當裝置嘗試在此動態環境中追蹤其本身時, 全息影像可能看起來像是跳躍或漂移。 如果您遇到這種情況, 建議您在較不動態的環境中使用裝置。

### <a name="headset-tracks-incorrectly-because-the-environment-has-changed-significantly-over-time"></a>頭戴式裝置播放錯誤, 因為環境在一段時間內已大幅改變

有時候, 當您開始在經歷大量變更的環境中使用耳機時 (例如, 傢俱、牆 hangings 等的重要移動), 可能會有部分的全息影像可能會從其原始位置中移出。 當使用者在此新空間中四處移動時, 先前的全息影像也可能會跳過。 這是因為系統對您的空間的瞭解不會再保留, 而且它會在嘗試協調房間的功能時, 嘗試重新對應環境。 在此案例中, 建議您鼓勵使用者在不會如預期般出現的情況下, 將其釘選到全球的全息影像。

### <a name="headset-tracks-incorrectly-due-to-identical-spaces-in-an-environment"></a>頭戴式裝置追蹤不正確, 因為環境中的空間相同

有時候, 家庭或其他空間可能會有兩個相同的區域。 例如, 兩個相同的會議室、兩個相同的角落區域、兩個完全相同的海報, 涵蓋裝置的視野。 在這種情況下, 裝置有時可能會混淆相同的元件, 並在其內部標記法中將它們標示為相同。 這可能會導致某些區域的全息影像出現在其他位置。 裝置可能會開始遺失追蹤, 因為它的內部表示環境已損毀。 在此情況下, 建議您重設系統的環境理解。 請注意, 重設地圖會導致所有空間錨點放置遺失。 這會導致耳機在環境的獨特區域中順利追蹤。 不過, 如果裝置在相同區域之間再次混淆, 則可能會重新發生此問題。

## <a name="see-also"></a>另請參閱
* [GDC 2017 呈現空間座標系統和全像攝影轉譯](https://channel9.msdn.com/events/GDC/GDC-2017/GDC2017-008)
* [Unity 中的座標系統](coordinate-systems-in-unity.md)
* [DirectX 中的座標系統](coordinate-systems-in-directx.md)
* [空間錨點](spatial-anchors.md)
* [混合實境中的共用體驗](shared-experiences-in-mixed-reality.md)
* <a href="https://docs.microsoft.com/azure/spatial-anchors" target="_blank">Azure Spatial Anchors</a>
* [案例研究 - 在實境中的的透視技術](case-study-looking-through-holes-in-your-reality.md)
